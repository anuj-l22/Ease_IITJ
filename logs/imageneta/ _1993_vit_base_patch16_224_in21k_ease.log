2024-10-02 13:43:47,535 [trainer.py] => config: ./exps/ease_ina_in21k.json
2024-10-02 13:43:47,536 [trainer.py] => prefix:  
2024-10-02 13:43:47,536 [trainer.py] => dataset: imageneta
2024-10-02 13:43:47,536 [trainer.py] => memory_size: 0
2024-10-02 13:43:47,536 [trainer.py] => memory_per_class: 0
2024-10-02 13:43:47,536 [trainer.py] => fixed_memory: False
2024-10-02 13:43:47,536 [trainer.py] => shuffle: True
2024-10-02 13:43:47,536 [trainer.py] => init_cls: 20
2024-10-02 13:43:47,537 [trainer.py] => increment: 20
2024-10-02 13:43:47,537 [trainer.py] => model_name: ease
2024-10-02 13:43:47,537 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-10-02 13:43:47,537 [trainer.py] => device: [device(type='cuda', index=0)]
2024-10-02 13:43:47,537 [trainer.py] => seed: 1993
2024-10-02 13:43:47,537 [trainer.py] => init_epochs: 20
2024-10-02 13:43:47,537 [trainer.py] => init_lr: 0.05
2024-10-02 13:43:47,537 [trainer.py] => later_epochs: 20
2024-10-02 13:43:47,537 [trainer.py] => later_lr: 0.05
2024-10-02 13:43:47,537 [trainer.py] => batch_size: 32
2024-10-02 13:43:47,537 [trainer.py] => weight_decay: 0.005
2024-10-02 13:43:47,538 [trainer.py] => min_lr: 0
2024-10-02 13:43:47,538 [trainer.py] => optimizer: sgd
2024-10-02 13:43:47,538 [trainer.py] => scheduler: cosine
2024-10-02 13:43:47,538 [trainer.py] => pretrained: True
2024-10-02 13:43:47,538 [trainer.py] => vpt_type: Deep
2024-10-02 13:43:47,538 [trainer.py] => prompt_token_num: 5
2024-10-02 13:43:47,538 [trainer.py] => ffn_num: 64
2024-10-02 13:43:47,538 [trainer.py] => use_diagonal: False
2024-10-02 13:43:47,538 [trainer.py] => recalc_sim: True
2024-10-02 13:43:47,538 [trainer.py] => alpha: 0.1
2024-10-02 13:43:47,538 [trainer.py] => use_init_ptm: False
2024-10-02 13:43:47,538 [trainer.py] => beta: 0
2024-10-02 13:43:47,539 [trainer.py] => use_old_data: False
2024-10-02 13:43:47,539 [trainer.py] => use_reweight: True
2024-10-02 13:43:47,539 [trainer.py] => moni_adam: False
2024-10-02 13:43:47,539 [trainer.py] => adapter_num: -1
2024-10-02 13:43:47,976 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-02 13:43:53,431 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg_in21k)
2024-10-02 13:43:53,758 [_hub.py] => [timm/vit_base_patch16_224.augreg_in21k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2024-10-02 13:43:53,914 [trainer.py] => All params: 86988288
2024-10-02 13:43:53,914 [trainer.py] => Trainable params: 1189632
2024-10-02 13:43:53,922 [ease.py] => Learning on 0-20
2024-10-02 13:47:01,275 [ease.py] => Task 0, Epoch 20/20 => Loss 0.447, Train_accy 90.92
2024-10-02 13:47:10,958 [ease.py] => Task correct: 100.0
2024-10-02 13:47:10,959 [ease.py] => Task acc: 81.14285714285714
2024-10-02 13:47:10,976 [trainer.py] => No NME accuracy.
2024-10-02 13:47:10,976 [trainer.py] => CNN: {'total': 81.14, '00-19': 81.14, 'old': 0, 'new': 81.14}
2024-10-02 13:47:10,976 [trainer.py] => CNN top1 curve: [81.14]
2024-10-02 13:47:10,976 [trainer.py] => CNN top5 curve: [97.71]

2024-10-02 13:47:10,976 [trainer.py] => Average Accuracy (CNN): 81.14 

2024-10-02 13:47:10,976 [trainer.py] => All params: 87019010
2024-10-02 13:47:10,977 [trainer.py] => Trainable params: 1189632
2024-10-02 13:47:10,978 [ease.py] => Learning on 20-40
2024-10-02 13:50:31,430 [ease.py] => Task 1, Epoch 20/20 => Loss 0.560, Train_accy 86.95
2024-10-02 13:50:50,487 [ease.py] => Task correct: 87.5
2024-10-02 13:50:50,488 [ease.py] => Task acc: 81.66666666666667
2024-10-02 13:50:50,504 [trainer.py] => No NME accuracy.
2024-10-02 13:50:50,504 [trainer.py] => CNN: {'total': 75.28, '00-19': 72.57, '20-39': 77.84, 'old': 72.57, 'new': 77.84}
2024-10-02 13:50:50,504 [trainer.py] => CNN top1 curve: [81.14, 75.28]
2024-10-02 13:50:50,504 [trainer.py] => CNN top5 curve: [97.71, 94.44]

2024-10-02 13:50:50,504 [trainer.py] => Average Accuracy (CNN): 78.21000000000001 

2024-10-02 13:50:50,505 [trainer.py] => All params: 87065090
2024-10-02 13:50:50,505 [trainer.py] => Trainable params: 1189632
2024-10-02 13:50:50,506 [ease.py] => Learning on 40-60
2024-10-02 13:53:21,264 [ease.py] => Task 2, Epoch 20/20 => Loss 0.478, Train_accy 92.17
2024-10-02 13:53:45,824 [ease.py] => Task correct: 80.25210084033614
2024-10-02 13:53:45,825 [ease.py] => Task acc: 81.5126050420168
2024-10-02 13:53:45,844 [trainer.py] => No NME accuracy.
2024-10-02 13:53:45,844 [trainer.py] => CNN: {'total': 70.59, '00-19': 69.14, '20-39': 71.35, '40-59': 71.55, 'old': 70.28, 'new': 71.55}
2024-10-02 13:53:45,844 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59]
2024-10-02 13:53:45,844 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23]

2024-10-02 13:53:45,845 [trainer.py] => Average Accuracy (CNN): 75.67 

2024-10-02 13:53:45,845 [trainer.py] => All params: 87141890
2024-10-02 13:53:45,846 [trainer.py] => Trainable params: 1189632
2024-10-02 13:53:45,848 [ease.py] => Learning on 60-80
2024-10-02 13:57:09,851 [ease.py] => Task 3, Epoch 20/20 => Loss 0.469, Train_accy 89.41
2024-10-02 13:57:52,361 [ease.py] => Task correct: 74.35530085959886
2024-10-02 13:57:52,362 [ease.py] => Task acc: 83.6676217765043
2024-10-02 13:57:52,378 [trainer.py] => No NME accuracy.
2024-10-02 13:57:52,379 [trainer.py] => CNN: {'total': 68.19, '00-19': 60.0, '20-39': 65.41, '40-59': 64.66, '60-79': 78.83, 'old': 63.24, 'new': 78.83}
2024-10-02 13:57:52,379 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19]
2024-10-02 13:57:52,379 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11]

2024-10-02 13:57:52,379 [trainer.py] => Average Accuracy (CNN): 73.80000000000001 

2024-10-02 13:57:52,379 [trainer.py] => All params: 87249410
2024-10-02 13:57:52,379 [trainer.py] => Trainable params: 1189632
2024-10-02 13:57:52,382 [ease.py] => Learning on 80-100
2024-10-02 14:00:25,517 [ease.py] => Task 4, Epoch 20/20 => Loss 0.432, Train_accy 91.98
2024-10-02 14:01:14,477 [ease.py] => Task correct: 70.27348394768133
2024-10-02 14:01:14,478 [ease.py] => Task acc: 83.70986920332938
2024-10-02 14:01:14,498 [trainer.py] => No NME accuracy.
2024-10-02 14:01:14,498 [trainer.py] => CNN: {'total': 65.52, '00-19': 55.43, '20-39': 63.24, '40-59': 62.07, '60-79': 76.58, '80-99': 66.43, 'old': 65.33, 'new': 66.43}
2024-10-02 14:01:14,498 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52]
2024-10-02 14:01:14,498 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28]

2024-10-02 14:01:14,498 [trainer.py] => Average Accuracy (CNN): 72.144 

2024-10-02 14:01:14,499 [trainer.py] => All params: 87387650
2024-10-02 14:01:14,499 [trainer.py] => Trainable params: 1189632
2024-10-02 14:01:14,504 [ease.py] => Learning on 100-120
2024-10-02 14:03:46,679 [ease.py] => Task 5, Epoch 20/20 => Loss 0.396, Train_accy 93.88
2024-10-02 14:04:48,993 [ease.py] => Task correct: 67.8974358974359
2024-10-02 14:04:48,994 [ease.py] => Task acc: 84.1025641025641
2024-10-02 14:04:49,010 [trainer.py] => No NME accuracy.
2024-10-02 14:04:49,010 [trainer.py] => CNN: {'total': 64.1, '00-19': 54.29, '20-39': 60.0, '40-59': 61.21, '60-79': 75.68, '80-99': 65.03, '100-119': 64.93, 'old': 63.97, 'new': 64.93}
2024-10-02 14:04:49,010 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52, 64.1]
2024-10-02 14:04:49,010 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28, 86.05]

2024-10-02 14:04:49,010 [trainer.py] => Average Accuracy (CNN): 70.80333333333334 

2024-10-02 14:04:49,011 [trainer.py] => All params: 87556610
2024-10-02 14:04:49,011 [trainer.py] => Trainable params: 1189632
2024-10-02 14:04:49,016 [ease.py] => Learning on 120-140
2024-10-02 14:07:24,580 [ease.py] => Task 6, Epoch 20/20 => Loss 0.563, Train_accy 88.31
2024-10-02 14:08:43,200 [ease.py] => Task correct: 63.60392506690455
2024-10-02 14:08:43,201 [ease.py] => Task acc: 83.05084745762711
2024-10-02 14:08:43,221 [trainer.py] => No NME accuracy.
2024-10-02 14:08:43,221 [trainer.py] => CNN: {'total': 59.95, '00-19': 47.43, '20-39': 57.84, '40-59': 56.9, '60-79': 69.82, '80-99': 64.34, '100-119': 62.69, '120-139': 58.22, 'old': 60.21, 'new': 58.22}
2024-10-02 14:08:43,221 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52, 64.1, 59.95]
2024-10-02 14:08:43,221 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28, 86.05, 83.94]

2024-10-02 14:08:43,221 [trainer.py] => Average Accuracy (CNN): 69.25285714285715 

2024-10-02 14:08:43,221 [trainer.py] => All params: 87756290
2024-10-02 14:08:43,222 [trainer.py] => Trainable params: 1189632
2024-10-02 14:08:43,229 [ease.py] => Learning on 140-160
2024-10-02 14:11:17,046 [ease.py] => Task 7, Epoch 20/20 => Loss 0.522, Train_accy 91.53
2024-10-02 14:12:50,852 [ease.py] => Task correct: 61.69871794871795
2024-10-02 14:12:50,852 [ease.py] => Task acc: 82.8525641025641
2024-10-02 14:12:50,872 [trainer.py] => No NME accuracy.
2024-10-02 14:12:50,872 [trainer.py] => CNN: {'total': 58.09, '00-19': 46.86, '20-39': 57.3, '40-59': 56.9, '60-79': 69.37, '80-99': 62.94, '100-119': 61.19, '120-139': 56.85, '140-159': 48.82, 'old': 59.14, 'new': 48.82}
2024-10-02 14:12:50,872 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52, 64.1, 59.95, 58.09]
2024-10-02 14:12:50,872 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28, 86.05, 83.94, 82.05]

2024-10-02 14:12:50,872 [trainer.py] => Average Accuracy (CNN): 67.8575 

2024-10-02 14:12:50,873 [trainer.py] => All params: 87986690
2024-10-02 14:12:50,873 [trainer.py] => Trainable params: 1189632
2024-10-02 14:12:50,882 [ease.py] => Learning on 160-180
2024-10-02 14:15:32,709 [ease.py] => Task 8, Epoch 20/20 => Loss 0.662, Train_accy 87.39
2024-10-02 14:17:27,076 [ease.py] => Task correct: 59.2831541218638
2024-10-02 14:17:27,076 [ease.py] => Task acc: 82.22222222222223
2024-10-02 14:17:27,096 [trainer.py] => No NME accuracy.
2024-10-02 14:17:27,096 [trainer.py] => CNN: {'total': 55.91, '00-19': 45.71, '20-39': 56.76, '40-59': 51.72, '60-79': 68.92, '80-99': 60.84, '100-119': 60.45, '120-139': 56.85, '140-159': 48.03, '160-179': 47.62, 'old': 56.89, 'new': 47.62}
2024-10-02 14:17:27,097 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52, 64.1, 59.95, 58.09, 55.91]
2024-10-02 14:17:27,097 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28, 86.05, 83.94, 82.05, 79.78]

2024-10-02 14:17:27,097 [trainer.py] => Average Accuracy (CNN): 66.53 

2024-10-02 14:17:27,097 [trainer.py] => All params: 88247810
2024-10-02 14:17:27,098 [trainer.py] => Trainable params: 1189632
2024-10-02 14:17:27,108 [ease.py] => Learning on 180-200
2024-10-02 14:20:00,751 [ease.py] => Task 9, Epoch 20/20 => Loss 0.447, Train_accy 95.07
2024-10-02 14:22:12,622 [ease.py] => Task correct: 57.6036866359447
2024-10-02 14:22:12,623 [ease.py] => Task acc: 81.96181698485846
2024-10-02 14:22:12,640 [trainer.py] => No NME accuracy.
2024-10-02 14:22:12,640 [trainer.py] => CNN: {'total': 54.64, '00-19': 44.0, '20-39': 55.14, '40-59': 51.72, '60-79': 67.12, '80-99': 59.44, '100-119': 56.72, '120-139': 55.48, '140-159': 48.03, '160-179': 46.94, '180-199': 56.45, 'old': 54.48, 'new': 56.45}
2024-10-02 14:22:12,640 [trainer.py] => CNN top1 curve: [81.14, 75.28, 70.59, 68.19, 65.52, 64.1, 59.95, 58.09, 55.91, 54.64]
2024-10-02 14:22:12,640 [trainer.py] => CNN top5 curve: [97.71, 94.44, 92.23, 90.11, 87.28, 86.05, 83.94, 82.05, 79.78, 78.41]

2024-10-02 14:22:12,640 [trainer.py] => Average Accuracy (CNN): 65.341 

